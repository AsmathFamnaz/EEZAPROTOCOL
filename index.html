<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>The Final Gate — EEZA Protocol</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Inter:wght@300;400;600&display=swap');

  body {
    margin: 0;
    min-height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
    background: url('background.png') center/cover no-repeat;
    font-family: 'Inter', sans-serif;
    color: #e6eef8;
    overflow: hidden;
  }

  .card {
    background: rgba(15, 23, 36, 0.72);
    border: 1px solid rgba(125, 211, 252, 0.12);
    box-shadow: 0 10px 30px rgba(2,6,23,0.6);
    padding: 32px 40px;
    border-radius: 16px;
    backdrop-filter: blur(10px);
    text-align: center;
    max-width: 480px;
    width: 90%;
    animation: fadeIn 800ms ease;
  }

  @keyframes fadeIn { from { opacity: 0; transform: translateY(20px) } to { opacity: 1; transform: translateY(0) } }

  h3 {
    font-family: 'Orbitron', sans-serif;
    letter-spacing: 2px;
    color: #7dd3fc;
    font-size: 1.5rem;
    margin: 4px 0 18px;
    text-shadow: 0 0 10px rgba(56,189,248,0.35);
  }

  #timerDisplay {
    font-family: 'Orbitron', sans-serif;
    font-size: 28px;
    font-weight: 700;
    color: #ff7b7b;
    text-shadow: 0 0 12px rgba(255,0,0,0.18);
    margin-bottom: 18px;
  }

  label {
    font-weight: 600;
    color: #aee0ff;
    display: block;
    margin-bottom: 6px;
  }

  select, input {
    width: 80%;
    padding: 10px;
    border-radius: 8px;
    border: 1px solid rgba(255,255,255,0.08);
    background: rgba(255,255,255,0.03);
    color: #e6eef8;
    font-size: 15px;
    margin: 6px 0 12px;
    outline: none;
    transition: box-shadow .18s, border-color .18s, transform .08s;
  }

  select:focus, input:focus {
    border-color: #7dd3fc;
    box-shadow: 0 0 10px rgba(56,189,248,0.12);
    transform: translateY(-1px);
  }

  .controls { margin-top: 6px; display:flex; justify-content:center; gap:10px; flex-wrap:wrap; }

  button {
    padding: 11px 18px;
    font-size: 14px;
    border: none;
    border-radius: 8px;
    background: linear-gradient(90deg, #2dd4bf, #7dd3fc);
    color: #042027;
    cursor: pointer;
    font-weight: 700;
    letter-spacing: .6px;
    text-transform: uppercase;
    transition: transform .12s ease, box-shadow .12s ease, opacity .12s ease;
  }

  button:disabled {
    opacity: .45;
    cursor: not-allowed;
  }

  button:not(:disabled):hover {
    transform: translateY(-3px);
    box-shadow: 0 10px 24px rgba(34,211,238,0.12);
  }

  /* Banners */
  .banner {
    position: fixed;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
    text-align: center;
    font-family: 'Orbitron', sans-serif;
    font-weight: 700;
    letter-spacing: 3px;
    text-transform: uppercase;
    background: rgba(0,0,0,0.25);
    padding: 30px 44px;
    border-radius: 12px;
    display: none;
    z-index: 1000;
    backdrop-filter: blur(4px);
    animation: flickerMove 1.4s infinite;
  }

  .banner.show { display:block; }

  /* ACCESS GRANTED */
  #virus {
    color: #b8ffb2;
    text-shadow: 0 0 22px #00ff66, 0 0 48px #00ff66;
    border: 1px solid rgba(0,255,102,0.08);
  }

  /* WRONG CODE */
  #alertBanner {
    color: #ffbaba;
    text-shadow: 0 0 22px #ff2222, 0 0 48px #ff1111;
    border: 1px solid rgba(255,0,0,0.12);
  }

  /* TIME OVER */
  #timeUpBanner {
    color: #ffe4b8;
    text-shadow: 0 0 22px #ffa200, 0 0 48px #ff7b00;
    border: 1px solid rgba(255,150,0,0.2);
  }

  @keyframes flickerMove {
    0%,100% { opacity: 1; transform: translate(-50%,-50%) scale(1) }
    50% { opacity: 0.78; transform: translate(-50%,-52%) scale(1.02) }
  }

  @media (max-width:420px) {
    #timerDisplay { font-size: 22px; }
    .card { padding: 22px; }
    select, input { width: 90%; }
  }
</style>
</head>
<body>
  <div class="card" id="mainCard">
    <div id="timerDisplay">Time Left: 15:00</div>
    <h3>THE FINAL GATE</h3>

    <form id="finalForm" onsubmit="return false">
      <label for="groupSelect">Select Group</label>
      <select id="groupSelect">
        <option value="">-- Choose Group --</option>
        <option value="1">Group 1</option>
        <option value="2">Group 2</option>
        <option value="3">Group 3</option>
        <option value="4">Group 4</option>
        <option value="5">Group 5</option>
        <option value="6">Group 6</option>
      </select>

      <div class="controls">
        <button id="startBtn" type="button" disabled>Start Timer</button>
        <input id="secretCode" type="text" maxlength="20" placeholder="Enter secret code" />
        <button id="checkBtn" type="button">Validate</button>
      </div>
    </form>
  </div>

  <!-- ✅ Access Granted -->
  <div id="virus" class="banner">
    <div style="font-size:56px; margin-bottom:8px; line-height:0.9;">ACCESS GRANTED</div>
    <div style="font-size:20px; opacity:0.95;">Network Restored</div>
  </div>

  <!-- ❌ Wrong Code -->
  <div id="alertBanner" class="banner">
    <div style="font-size:50px; margin-bottom:10px;">VIRUS SPREADING!</div>
    <div style="font-size:18px;">Maintain close control!</div>
  </div>

  <!-- ⏰ Time Over -->
  <div id="timeUpBanner" class="banner">
    <div style="font-size:46px; margin-bottom:10px;">TIME’S UP!</div>
    <div style="font-size:18px;">The virus took control of the system.</div>
  </div>

<script>
(() => {
  const VALID_CODES = {1:"CRYPTO",2:"SECRET",3:"OMEGA9",4:"ZENIX42",5:"SPY2025",6:"REDWALL"};
  const groupSelect = document.getElementById('groupSelect');
  const secretCode = document.getElementById('secretCode');
  const startBtn = document.getElementById('startBtn');
  const checkBtn = document.getElementById('checkBtn');
  const timerDisplay = document.getElementById('timerDisplay');
  const mainCard = document.getElementById('mainCard');

  const virus = document.getElementById('virus');
  const alertBanner = document.getElementById('alertBanner');
  const timeUpBanner = document.getElementById('timeUpBanner');

  const TOTAL = 15 * 60;
  let timeLeft = TOTAL;
  let timer = null;
  let groupKey = null;

  function formatTime(t) {
    const m = Math.floor(t/60), s = t%60;
    return `${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`;
  }

  function updateTimerDisplay() {
    timerDisplay.textContent = `Time Left: ${formatTime(timeLeft)}`;
  }

  function saveTimer() {
    if (!groupKey) return;
    const data = JSON.parse(localStorage.getItem(groupKey)) || {};
    data.remaining = timeLeft;
    data.started = true;
    localStorage.setItem(groupKey, JSON.stringify(data));
  }

  function startCountdown() {
    if (timer) clearInterval(timer);
    timer = setInterval(() => {
      if (timeLeft > 0) {
        timeLeft--;
        saveTimer();
        updateTimerDisplay();
      } else {
        clearInterval(timer);
        timer = null;
        mainCard.style.display = 'none';
        timeUpBanner.classList.add('show');
      }
    }, 1000);
  }

  function refreshControls() {
    startBtn.disabled = !groupSelect.value;
  }

  groupSelect.addEventListener('change', () => {
    if (!groupSelect.value) {
      groupKey = null;
      timeLeft = TOTAL;
      updateTimerDisplay();
      refreshControls();
      return;
    }
    groupKey = `group_${groupSelect.value}_timer`;
    const saved = JSON.parse(localStorage.getItem(groupKey));
    timeLeft = (saved && saved.remaining != null) ? saved.remaining : TOTAL;
    updateTimerDisplay();
    refreshControls();
  });

  startBtn.addEventListener('click', () => {
    if (!groupSelect.value) return;
    const saved = JSON.parse(localStorage.getItem(groupKey));
    timeLeft = (saved && saved.remaining != null) ? saved.remaining : TOTAL;
    updateTimerDisplay();
    startCountdown();
    startBtn.disabled = true;
    groupSelect.disabled = true;
  });

  checkBtn.addEventListener('click', () => {
    if (!groupSelect.value) return;
    const code = (secretCode.value || '').trim().toUpperCase();

    if (code === VALID_CODES[groupSelect.value]) {
      clearInterval(timer);
      virus.classList.add('show');
      mainCard.style.display = 'none';

      const saved = JSON.parse(localStorage.getItem(groupKey)) || {};
      saved.validated = true;
      saved.timeTaken = TOTAL - timeLeft;
      saved.validatedAt = new Date().toLocaleTimeString();
      localStorage.setItem(groupKey, JSON.stringify(saved));
    } else {
      // Wrong code!
      alertBanner.classList.add('show');
      setTimeout(() => alertBanner.classList.remove('show'), 2500);
      secretCode.value = '';
      secretCode.focus();
    }
  });

  updateTimerDisplay();
  refreshControls();
})();
</script>
</body>
</html>
